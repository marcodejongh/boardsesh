; PlatformIO Unit Test Configuration
;
; This configuration is for running native unit tests on the host machine.
; Tests run without requiring actual ESP32 hardware.
;
; Run tests with: pio test -e native
; Run specific test: pio test -e native -f test_aurora_protocol

[platformio]
default_envs = native
; No src_dir needed - tests are standalone
test_dir = .

[env:native]
platform = native
build_flags =
    -std=c++17
    -D UNIT_TEST
    -D NATIVE_BUILD
; Use symlinked libraries in lib/ directory
lib_deps =
    mocks
    aurora-protocol
    log-buffer
    led-controller
    config-manager
    wifi-utils
    graphql-ws-client
    nordic-uart-ble
    esp-web-server
    climb-history
    grade-colors
    ble-proxy
lib_extra_dirs =
    lib
test_framework = unity
; Only run our test_* directories, exclude Unity's bundled examples
test_filter = test_*

; Coverage support (uncomment for coverage reports)
; build_flags = ${env:native.build_flags} -fprofile-arcs -ftest-coverage
